-- GENERATED CODE
-- Node Box Editor, version 0.7 - Iron
 
local liquid_portal_nodebox = {
		type = "fixed",
		fixed = {
			{-0.125, -0.375, -0.125, 0.125, 0.375, 0.125}, -- NodeBox6
			{-0.25, -0.3125, -0.125, 0.25, 0.3125, 0.125}, -- NodeBox7
			{-0.125, -0.3125, -0.25, 0.125, 0.3125, 0.25}, -- NodeBox9
			{-0.1875, -0.3125, -0.1875, 0.1875, 0.3125, 0.1875}, -- NodeBox15
			{-0.3125, -0.25, -0.125, 0.3125, 0.25, 0.125}, -- NodeBox16
			{-0.125, -0.25, -0.3125, 0.125, 0.25, 0.3125}, -- NodeBox17
			{-0.1875, -0.25, -0.25, 0.1875, 0.25, 0.25}, -- NodeBox19
			{-0.25, -0.25, -0.1875, 0.25, 0.25, 0.1875}, -- NodeBox20
			{-0.25, -0.1875, -0.25, 0.25, 0.1875, 0.25}, -- NodeBox21
			{-0.3125, -0.1875, -0.1875, 0.3125, 0.1875, 0.1875}, -- NodeBox22
			{-0.1875, -0.1875, -0.3125, 0.1875, 0.1875, 0.3125}, -- NodeBox23
			{-0.125, -0.125, -0.375, 0.125, 0.125, 0.375}, -- NodeBox24
			{-0.375, -0.125, -0.125, 0.375, 0.125, 0.125}, -- NodeBox25
			{-0.3125, -0.125, -0.1875, 0.3125, 0.125, 0.1875}, -- NodeBox26
			{-0.1875, -0.125, -0.3125, 0.1875, 0.125, 0.3125}, -- NodeBox27
			{-0.25, -0.125, -0.25, 0.25, 0.125, 0.25}, -- NodeBox28
			{-0.5, -0.5, -0.5, -0.3125, 0.5, -0.4375}, -- NodeBox30
			{-0.5, -0.5, -0.4375, -0.4375, 0.5, -0.3125}, -- NodeBox31
			{-0.5, -0.5, 0.4375, -0.3125, 0.5, 0.5}, -- NodeBox32
			{-0.5, -0.5, 0.3125, -0.4375, 0.5, 0.4375}, -- NodeBox33
			{0.4375, -0.5, 0.3125, 0.5, 0.5, 0.5}, -- NodeBox34
			{0.3125, -0.5, 0.4375, 0.5, 0.5, 0.5}, -- NodeBox35
			{0.3125, -0.5, -0.5, 0.5, 0.5, -0.4375}, -- NodeBox36
			{0.4375, -0.5, -0.4375, 0.5, 0.5, -0.3125}, -- NodeBox37
			{-0.5, -0.5, -0.5, 0.5, -0.4375, -0.3125}, -- NodeBox38
			{-0.5, -0.5, 0.3125, 0.5, -0.4375, 0.5}, -- NodeBox39
			{0.3125, -0.5, -0.5, 0.5, -0.4375, 0.5}, -- NodeBox40
			{-0.5, -0.5, -0.5, -0.3125, -0.4375, 0.5}, -- NodeBox41
			{-0.5, -0.5, -0.5, 0.5, -0.3125, -0.4375}, -- NodeBox42
			{0.4375, -0.5, -0.5, 0.5, -0.3125, 0.5}, -- NodeBox43
			{-0.5, -0.5, -0.5, -0.4375, -0.3125, 0.5}, -- NodeBox44
			{-0.5, -0.5, 0.4375, 0.5, -0.3125, 0.5}, -- NodeBox45
			{-0.5, 0.4375, -0.5, -0.3125, 0.5, 0.5}, -- NodeBox46
			{-0.5, 0.4375, 0.3125, 0.5, 0.5, 0.5}, -- NodeBox47
			{0.3125, 0.4375, -0.5, 0.5, 0.5, 0.5}, -- NodeBox48
			{-0.5, 0.4375, -0.5, 0.5, 0.5, -0.3125}, -- NodeBox49
			{-0.5, 0.3125, 0.4375, 0.5, 0.5, 0.5}, -- NodeBox50
			{-0.5, 0.3125, -0.5, -0.4375, 0.5, 0.5}, -- NodeBox51
			{-0.5, 0.3125, -0.5, 0.5, 0.5, -0.4375}, -- NodeBox52
			{0.4375, 0.3125, -0.5, 0.5, 0.5, 0.5}, -- NodeBox53
		}
	} 

local ray_node_fixed_box = {
			{0.4375, -0.5, -0.125, 0.5, 0.5, 0.125}, -- NodeBox1
			{0.375, -0.5, 0.125, 0.4375, 0.5, 0.25}, -- NodeBox2
			{0.3125, -0.5, 0.25, 0.375, 0.5, 0.3125}, -- NodeBox3
			{0.25, -0.5, 0.25, 0.3125, 0.5, 0.375}, -- NodeBox4
			{0.125, -0.5, 0.375, 0.25, 0.5, 0.4375}, -- NodeBox5
			{-0.125, -0.5, 0.4375, 0.125, 0.5, 0.5}, -- NodeBox6
			{-0.25, -0.5, 0.375, -0.125, 0.5, 0.4375}, -- NodeBox7
			{-0.3125, -0.5, 0.25, -0.25, 0.5, 0.375}, -- NodeBox8
			{-0.375, -0.5, 0.25, -0.3125, 0.5, 0.3125}, -- NodeBox9
			{-0.4375, -0.5, 0.125, -0.375, 0.5, 0.25}, -- NodeBox10
			{-0.5, -0.5, -0.125, -0.4375, 0.5, 0.125}, -- NodeBox11
			{-0.125, -0.5, -0.5, 0.125, 0.5, -0.4375}, -- NodeBox12
			{-0.25, -0.5, -0.4375, -0.125, 0.5, -0.375}, -- NodeBox13
			{-0.4375, -0.5, -0.25, -0.375, 0.5, -0.125}, -- NodeBox14
			{-0.375, -0.5, -0.3125, -0.25, 0.5, -0.25}, -- NodeBox15
			{-0.3125, -0.5, -0.375, -0.25, 0.5, -0.3125}, -- NodeBox18
			{0.125, -0.5, -0.4375, 0.25, 0.5, -0.375}, -- NodeBox19
			{0.375, -0.5, -0.25, 0.4375, 0.5, -0.125}, -- NodeBox20
			{0.25, -0.5, -0.375, 0.375, 0.5, -0.3125}, -- NodeBox21
			{0.3125, -0.5, -0.3125, 0.375, 0.5, -0.25}, -- NodeBox22
		}


-- GENERATED CODE
-- Node Box Editor, version 0.7 - Iron
-- Namespace: test

local register_portal_ray = function(name ,texture, post_effect_color)

	minetest.register_node(name, {
		tiles = {
			"ray_y_tile.png",
			"ray_y_tile.png",
			texture,
			texture,
			texture,
			texture
		},
		paramtype="light",
		use_texture_alpha = true,
		walkable = false,
		pointable = false,
		diggable = false,
		drawtype = "nodebox",
		is_ground_content = true,
		light_source = LIGHT_MAX - 1,
		post_effect_color = post_effect_color, 
		node_box = {
			type = "fixed",
			fixed = ray_node_fixed_box
		}
	})
end
register_portal_ray("liquid_portals:water_portal_ray_bottom", "water_portal_ray_bottom.png", { r=125, g=198, b=198, a=50 })
register_portal_ray("liquid_portals:water_portal_ray_top", "water_portal_ray_top.png", { r=125, g=198, b=198, a=50 })
local water_portal_params =  {
 fuel = "bucket:bucket_water 1",
 active_node = "liquid_portals:water_portal_active", 
 inactive_node = "liquid_portals:water_portal",
 
 ray_bottom = {
 	name = "liquid_portals:water_portal_ray_bottom",
 	texture = "water_portal_ray_bottom.png"
 },
 ray_top = {
 	name = "liquid_portals:water_portal_ray_top",
 	texture = "water_portal_ray_top.png"
 },
 dig_sourroundings_on_activate = {
 	except_nodes_containing_in_name = {"water_source", "water_flowing", "portal_ray" },
 	offsets = {
 		-- if unspecified replacement_node_names, air is the default 
 		x = {values = {-1, 1}},
 		z = {values = {-1, 1}},
 		y = {values = {-1, 1, 2}, replacement_node_names = {"air", "liquid_portals:water_portal_ray_bottom", "liquid_portals:water_portal_ray_top"}}
 	}
 },
 clear_sourroundings_on_deactivate = {
 	except_nodes_containing_in_name = {"water_source", "water_flowing", "portal_ray" },
 	offsets = {
 		y = {values = {1, 2}, match_node_names = {"liquid_portals:water_portal_ray_bottom", "liquid_portals:water_portal_ray_top"}}
 	}
 }
}

element_portals:create_private_portal_node("liquid_portals:water_portal", {
	description = "Water Portal",
	tiles = {
		{name="portal_water_anim.png", animation={type="vertical_frames", aspect_w=16, aspect_h=16, length=2.0}}
	},
	drawtype = "nodebox",
	use_texture_alpha = false,
	is_ground_content = true,
	paramtype="light",
	node_box = liquid_portal_nodebox,
	groups = {cracky=3}
}, water_portal_params)



minetest.register_node("liquid_portals:water_flowing", {
	description = "Flowing Water",
	inventory_image = minetest.inventorycube("default_water.png"),
	drawtype = "flowingliquid",
	tiles = {"default_water.png"},
	special_tiles = {
		{
			image="default_water_flowing_animated.png",
			backface_culling=false,
			animation={type="vertical_frames", aspect_w=16, aspect_h=16, length=0.8}
		},
		{
			image="default_water_flowing_animated.png",
			backface_culling=true,
			animation={type="vertical_frames", aspect_w=16, aspect_h=16, length=0.8}
		},
	},
	alpha = WATER_ALPHA,
	paramtype = "light",
	paramtype2 = "flowingliquid",
	walkable = false,
	pointable = false,
	diggable = false,
	buildable_to = true,
	drop = "",
	drowning = 1,
	liquidtype = "flowing",
	liquid_alternative_flowing = "liquid_portals:water_flowing",
	liquid_alternative_source = "liquid_portals:water_portal_active",
	liquid_viscosity = WATER_VISC,
	freezemelt = "default:snow",
	post_effect_color = {a=64, r=100, g=100, b=200},
	groups = {water=3, liquid=3, puts_out_fire=1, not_in_creative_inventory=1, freezes=1, melt_around=1},
})


element_portals:create_private_portal_node("liquid_portals:water_portal_active", {
	description = "Active Water Portal",
	tiles = {
		{name="portal_water_anim_active.png", animation={type="vertical_frames", aspect_w=16, aspect_h=16, length=2.0}}
	},
	drawtype = "nodebox",
	use_texture_alpha = false,
	is_ground_content = true,
	paramtype="light",
	node_box = liquid_portal_nodebox,
	liquidtype = "source",
	liquid_alternative_flowing = "liquid_portals:water_flowing",
	liquid_alternative_source = "liquid_portals:water_portal_active",
	groups = {cracky=3, puts_out_fire=1},
}, water_portal_params)



minetest.register_node("liquid_portals:lava_flowing", {
	description = "Flowing Lava",	
	drawtype = "flowingliquid",
	tiles = {"default_lava.png"},
	special_tiles = {
		{
			image="default_lava_flowing_animated.png",
			backface_culling=false,
			animation={type="vertical_frames", aspect_w=16, aspect_h=16, length=3.3}
		},
		{
			image="default_lava_flowing_animated.png",
			backface_culling=true,
			animation={type="vertical_frames", aspect_w=16, aspect_h=16, length=3.3}
		},
	},

	paramtype = "light",
	paramtype2 = "flowingliquid",
	light_source = LIGHT_MAX - 1,
	walkable = false,
	pointable = false,
	diggable = false,
	drop = "",
	drowning = 1,
	liquidtype = "flowing",
	liquid_alternative_flowing = "liquid_portals:lava_flowing",
	liquid_alternative_source = "liquid_portals:lava_portal_active",
	liquid_viscosity = LAVA_VISC,
	liquid_renewable = false,
	damage_per_second = 4*2,
	post_effect_color = {a=192, r=255, g=64, b=0},
	groups = {lava=3, liquid=2, hot=3, igniter=1, not_in_creative_inventory=1},
})

register_portal_ray("liquid_portals:lava_portal_ray_bottom", "lava_portal_ray_bottom.png",  { r=255, g=172, b=93, a=50 })
register_portal_ray("liquid_portals:lava_portal_ray_top", "lava_portal_ray_top.png",   { r=255, g=172, b=93, a=50 })
local lava_portal_params =  {
 fuel = "bucket:bucket_lava 1",
 active_node = "liquid_portals:lava_portal_active", 
 inactive_node = "liquid_portals:lava_portal",
 leaks = "liquid_portals:lava_flowing",
 
 dig_sourroundings_on_activate = {
 	except_nodes_containing_in_name = {"lava_source", "lava_flowing", "portal_ray" },
 	offsets = {
 		-- if unspecified replacement_node_names, air is the default 
 		x = {values = {-1, 1}},
 		z = {values = {-1, 1}},
 		y = {values = {-1, 1, 2}, replacement_node_names = {"air", "liquid_portals:lava_portal_ray_bottom", "liquid_portals:lava_portal_ray_top"}}
 	}
 },
 clear_sourroundings_on_deactivate = {
 	except_nodes_containing_in_name = {"lava_source", "lava_flowing", "portal_ray" },
 	offsets = {
 		y = {values = {1, 2}, match_node_names = {"liquid_portals:lava_portal_ray_bottom", "liquid_portals:lava_portal_ray_top"}}
 	}
 }
 
 
}

element_portals:create_private_portal_node("liquid_portals:lava_portal", {
	description = "Lava Portal",
	drawtype = "nodebox",
	use_texture_alpha = false,
	is_ground_content = true,
	paramtype="light",
	node_box = liquid_portal_nodebox,
	tiles = {
		{name="portal_lava_anim.png", animation={type="vertical_frames", aspect_w=16, aspect_h=16, length=2.0}}
	},
	is_ground_content = false,
	groups = {cracky=3}

}, lava_portal_params  )

element_portals:create_private_portal_node("liquid_portals:lava_portal_active", {
	description = "Lava Portal Active",
	tiles = {
		{name="portal_lava_anim_active.png", animation={type="vertical_frames", aspect_w=16, aspect_h=16, length=2.0}}
	},
	drawtype = "nodebox",
	use_texture_alpha = false,
	is_ground_content = true,
	paramtype="light",	
	node_box = liquid_portal_nodebox,	
	
	
	groups = {cracky=3,hot=3, igniter=1},
	light_source = LIGHT_MAX - 1,
	liquidtype = "source",
	liquid_alternative_flowing = "liquid_portals:lava_flowing",
	liquid_alternative_source = "liquid_portals:lava_portal_active",
	liquid_renewable = false,
	post_effect_color = {a=192, r=255, g=64, b=0}
},  lava_portal_params )

